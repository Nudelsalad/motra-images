# OPC UA CVE-2022-21208 Attacker

This helper spams an OPC UA endpoint with oversized `OpenSecureChannel` chunks to reproduce CVE-2022-21208. Every worker thread opens a TCP session, sends a minimal `HEL` banner, then loops sending non-final `OPN` chunks padded to the requested size. With enough concurrent connections or large chunks this overwhelms vulnerable servers and triggers high CPU and memory use. The attack runs until container stop


## Usage

Set the following environment variables before launching the container or running the script directly:

| Variable | Default | Description |
|----------|---------|-------------|
| `HOST` | `opcua-server` | Target hostname or IP |
| `PORT` | `4840` | OPC UA TCP port |
| `CONNECTIONS` | `1` | Number of parallel TCP connections |
| `CHUNK_SIZE` | `1048576` | Payload size per chunk (bytes) |
| `SLEEP_BETWEEN` | `0` | Optional delay between chunks (seconds) |
| `LOG_EVERY` | `100` | Print progress every N chunks (set to `0` to disable) |

Example:

```bash
HOST=10.80.0.37 PORT=4840 CONNECTIONS=4 CHUNK_SIZE=2097152 ./attacker.py
```

